var CaptchaCallback = function () { var e = $("#recaptchaSiteKey").data("value"); document.getElementById("recaptchaField1") && grecaptcha.render("recaptchaField1", { sitekey: e }) }; $("#formularioPrincipal .next").click((function () { current_fs = $(this).parent(), next_fs = $(this).parent().next(), step = current_fs.find(".form-subtype").data().step, 1 == step || 2 == step ? "Si" == current_fs.find("input[name=eresNL]:checked").val() || "Si" == current_fs.find("input[name=historial]:checked").val() ? (next_fs.show(), current_fs.hide()) : (current_fs.html(""), $("#fstep" + step).addClass("step-end"), $("#fstep" + step).append("<legend>Gracias por tu interés</legend><p class='step-end-text'>Lo siento, pero lamentablemente no podemos proceder con la compra ya que no resides en Nuevo León, que es donde ofrecemos este servicio exclusivo.</p><div class='step-end-content'>Te invitamos a utilizar nuestra plataforma para ver y comparar autos nuevos.<img src='/images/form-end.webp'></div>")) : (next_fs.show(), current_fs.hide()) })), $("#formStep form").validate({ ignore: "", rules: { fullname: { required: !0 }, phoned: { required: !0, minlength: 10, maxlength: 10 }, emaild: { required: !0 }, cp: { required: !0, minlength: 5, maxlength: 5 }, asesoriaauto: { required: !0 } }, messages: { fullname: { required: "El nombre es requerido" }, phoned: { required: "El teléfono es requerido", minlength: "El teléfono debe tener al menos 10 dígitos", maxlength: "El teléfono no debe tener más de 10 dígitos" }, emaild: { required: "La dirección de correo es requerida." }, cp: { required: "El código postal es requerido.", minlength: "El código postal debe tener 5 dígitos", maxlength: "El código postal no debe tener más de 5 dígitos" }, asesoriaauto: { required: "Debes seleccionar un horario de contacto." } }, submitHandler: function (e, r) { r.preventDefault(); var t = $("input[name=eresNL]:checked").val(), n = $("input[name=historial]:checked").val(), a = $("input[name=personFM]:checked").val(), o = $("input[name=cIngresos]:checked").val(), i = $("input[name=asesoriaauto]:checked").val(), s = $("#fullname").val(), l = $("#phoned").val(), c = $("#emaild").val(), d = $("#cp").val(), u = $("#from").val(), p = grecaptcha.getResponse(0); if (!p) return $("#errorRecaptcha1").show(), void (document.getElementById("errorRecaptcha1").innerText = "Es necesario resolver el reCAPTCHA antes de enviar el formulario."); $("#errorRecaptcha1").hide(); var m = { nombre: s, telefono: l, email: c, cp: d, horario: i, from: u, eresNL: t, historial: n, personFM: a, tipoPer: o, RecaptchaResponse: p }; return e.querySelector('button[type="submit"]').innerHTML = '<span class="btn__text"> Cargando...</span><span class="spinner"></span>', e.querySelector('button[type="submit"]').disabled = !0, e.querySelector('button[type="submit"]').classList.add("btn-flex"), $.get("/api/car/antiforgery-token", (function (r) { $.ajax({ url: "/api/form/comenzar", type: "POST", contentType: "application/json; charset=utf-8", data: JSON.stringify(m), headers: { RequestVerificationToken: r.token } }).done((function (e) { $("#fstep5").html(""), $("#fstep5").addClass("final-form1"), $("#fstep5").append("<legend>Tu información ha sido enviada</legend>"), setTimeout(() => { window.location.reload() }, 2e3) })).fail((function (r, t, n) { console.error("Error al enviar formulario:", n), e.querySelector('button[type="submit"]').innerHTML = "Enviar", e.querySelector('button[type="submit"]').disabled = !1, e.querySelector('button[type="submit"]').classList.remove("btn-flex") })) })).fail((function () { console.error("Error al obtener token de verificación"), e.querySelector('button[type="submit"]').innerHTML = "Enviar", e.querySelector('button[type="submit"]').disabled = !1, e.querySelector('button[type="submit"]').classList.remove("btn-flex") })), !1 }, errorClass: "error" });